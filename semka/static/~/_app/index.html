<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
  </head>

  <body>
    <section id="app"></section>
    <script type="module">
      let pathParts = document.location.pathname.split("/");
      // first part is always "", last part ether "index.html" or ""
      pathParts = pathParts.slice(1, pathParts.length - 1);
      for (let i = pathParts.length - 1; i >= 0; i--) {
        if (pathParts[i].match(/~.*/)) {
          break;
        }
        pathParts.pop();
      }
      let basePath = pathParts.length === 0 ? "" : `/${pathParts.join("/")}`;
      console.debug(`Application base URL is "${basePath}/"`);
      import(`${basePath}/_app/package.js`)
        .then(({ default: init }) => {
          return init(`${basePath}/_app/package_bg.wasm`);
        })
        .catch((error) => console.error("Can not load application", error));
    </script>
  </body>
</html>
